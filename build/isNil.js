import{av as K,aw as T,af as k,p as b,al as z,ad as F,ae as I,aj as S,ak as B,r}from"./index.js";import{K as _,L as N,N as U,O as D,Q as G}from"./Views.js";var H=K;function Q(e){return e==null?"":H(e)}var ke=Q,V=Object.prototype;function W(e){var n=e&&e.constructor,t=typeof n=="function"&&n.prototype||V;return e===t}var $=W;function q(e,n){return function(t){return e(n(t))}}var J=q,X=J,Y=X(Object.keys,Object),Z=Y,ee=$,te=Z,re=Object.prototype,ne=re.hasOwnProperty;function se(e){if(!ee(e))return te(e);var n=[];for(var t in Object(e))ne.call(e,t)&&t!="constructor"&&n.push(t);return n}var oe=se,ie=T,ae=k;function ce(e){return e!=null&&ae(e.length)&&!ie(e)}var ue=ce,fe=oe,pe=z,de=F,le=I,me=ue,he=S,ye=$,ge=B,Ee="[object Map]",Ce="[object Set]",Re=Object.prototype,xe=Re.hasOwnProperty;function Pe(e){if(e==null)return!0;if(me(e)&&(le(e)||typeof e=="string"||typeof e.splice=="function"||he(e)||ge(e)||de(e)))return!e.length;var n=pe(e);if(n==Ee||n==Ce)return!e.size;if(ye(e))return!fe(e).length;for(var t in e)if(xe.call(e,t))return!1;return!0}var ve=Pe;const ze=b(ve);function A(){const e=r.useRef(!1);return _(()=>(e.current=!0,()=>{e.current=!1}),[]),e}function be(){const e=A(),[n,t]=r.useState(0),s=r.useCallback(()=>{e.current&&t(n+1)},[n]);return[r.useCallback(()=>N.postRender(s),[s]),n]}class _e extends r.Component{getSnapshotBeforeUpdate(n){const t=this.props.childRef.current;if(t&&n.isPresent&&!this.props.isPresent){const s=this.props.sizeRef.current;s.height=t.offsetHeight||0,s.width=t.offsetWidth||0,s.top=t.offsetTop,s.left=t.offsetLeft}return null}componentDidUpdate(){}render(){return this.props.children}}function $e({children:e,isPresent:n}){const t=r.useId(),s=r.useRef(null),l=r.useRef({width:0,height:0,top:0,left:0});return r.useInsertionEffect(()=>{const{width:d,height:p,top:u,left:h}=l.current;if(n||!s.current||!d||!p)return;s.current.dataset.motionPopId=t;const f=document.createElement("style");return document.head.appendChild(f),f.sheet&&f.sheet.insertRule(`
          [data-motion-pop-id="${t}"] {
            position: absolute !important;
            width: ${d}px !important;
            height: ${p}px !important;
            top: ${u}px !important;
            left: ${h}px !important;
          }
        `),()=>{document.head.removeChild(f)}},[n]),r.createElement(_e,{isPresent:n,childRef:s,sizeRef:l},r.cloneElement(e,{ref:s}))}const P=({children:e,initial:n,isPresent:t,onExitComplete:s,custom:l,presenceAffectsLayout:d,mode:p})=>{const u=U(Ae),h=r.useId(),f=r.useMemo(()=>({id:h,initial:n,isPresent:t,custom:l,onExitComplete:o=>{u.set(o,!0);for(const a of u.values())if(!a)return;s&&s()},register:o=>(u.set(o,!1),()=>u.delete(o))}),d?void 0:[t]);return r.useMemo(()=>{u.forEach((o,a)=>u.set(a,!1))},[t]),r.useEffect(()=>{!t&&!u.size&&s&&s()},[t]),p==="popLayout"&&(e=r.createElement($e,{isPresent:t},e)),r.createElement(D.Provider,{value:f},e)};function Ae(){return new Map}function we(e){return r.useEffect(()=>()=>e(),[])}const m=e=>e.key||"";function Oe(e,n){e.forEach(t=>{const s=m(t);n.set(s,t)})}function Le(e){const n=[];return r.Children.forEach(e,t=>{r.isValidElement(t)&&n.push(t)}),n}const Fe=({children:e,custom:n,initial:t=!0,onExitComplete:s,exitBeforeEnter:l,presenceAffectsLayout:d=!0,mode:p="sync"})=>{const u=r.useContext(G).forceRender||be()[0],h=A(),f=Le(e);let o=f;const a=r.useRef(new Map).current,y=r.useRef(o),g=r.useRef(new Map).current,C=r.useRef(!0);if(_(()=>{C.current=!1,Oe(f,g),y.current=o}),we(()=>{C.current=!0,g.clear(),a.clear()}),C.current)return r.createElement(r.Fragment,null,o.map(i=>r.createElement(P,{key:m(i),isPresent:!0,initial:t?void 0:!1,presenceAffectsLayout:d,mode:p},i)));o=[...o];const R=y.current.map(m),v=f.map(m),w=R.length;for(let i=0;i<w;i++){const c=R[i];v.indexOf(c)===-1&&!a.has(c)&&a.set(c,void 0)}return p==="wait"&&a.size&&(o=[]),a.forEach((i,c)=>{if(v.indexOf(c)!==-1)return;const x=g.get(c);if(!x)return;const O=R.indexOf(c);let E=i;if(!E){const L=()=>{g.delete(c),a.delete(c);const M=y.current.findIndex(j=>j.key===c);if(y.current.splice(M,1),!a.size){if(y.current=f,h.current===!1)return;u(),s&&s()}};E=r.createElement(P,{key:m(x),isPresent:!1,onExitComplete:L,custom:n,presenceAffectsLayout:d,mode:p},x),a.set(c,E)}o.splice(O,0,E)}),o=o.map(i=>{const c=i.key;return a.has(c)?i:r.createElement(P,{key:m(i),isPresent:!0,presenceAffectsLayout:d,mode:p},i)}),r.createElement(r.Fragment,null,a.size?o:o.map(i=>r.cloneElement(i)))};function Me(e){return e==null}var je=Me;const Ie=b(je);export{Fe as A,oe as _,Ie as a,ue as b,$ as c,J as d,ze as i,ke as t};
